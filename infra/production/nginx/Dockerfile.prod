FROM nginx:stable-alpine

# Nginx設定ファイルをコピー
COPY infra/production/nginx/backend.conf /etc/nginx/conf.d/default.conf

# SSL証明書ディレクトリを作成
RUN mkdir -p /etc/nginx/ssl

# ヘルスチェック用ディレクトリ作成
RUN mkdir -p /usr/share/nginx/html

# バックエンドファイルは volumesFrom で共有するため、ここではコピーしない
# Laravel コンテナの /var/www/html が自動的にマウントされる

# ポート公開
EXPOSE 80 443

CMD ["nginx", "-g", "daemon off;"]
