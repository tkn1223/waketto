# 支出わけっと

スキル向上を目的に、家計管理アプリケーション **支出わけっと** を作成しました。

これはシングルページアプリケーション (SPA) として作成しており、以下の技術を採用しております。<br>
フロントエンド：**TypeScript / Next.js**<br>
バックエンド：**PHP / Laravel**<br>
インフラ：**S3+CloudFront（静的サイト） / ECS（API）**<br>

開発環境には Docker を用いており、フロントエンドとバックエンドを分離したモノレポ構成で開発しています。

---

### １度の入力で、ふたつの視点。２度手間なしの、スマートな家計管理。

支出管理表と家計簿の機能を統合し、予算設定から実績管理、可視化まで一括で行える家計管理アプリケーションです。<br >
ユーザーモード（個人/共有）を切り替えることで、個人の家計とパートナー都の家計を柔軟に管理できます。

👩 家計簿をつけてはいるけど活用できていない<br >
🧑 恋人/夫婦の支払いの分担・清算に困っている<br >
こんな困りごとを解決するために作成したアプリケーションです。

サービス URL：https://waketto.com/

【 ゲストユーザーアカウント 】<br>
メールアドレス：waketto@sample.com<br>
パスワード：GuestAccount?1234

# 目次

1. [開発背景](#1開発背景)
2. [機能一覧](#2機能一覧)
3. [画面](#3画面)
4. [使用技術](#)
5. [アプリ開発の振り返り](#5アプリ開発の振り返り)
6. [今後の展望](#6今後の展望)

## 1.開発背景

私は社会人になってから、いくつもの家計簿アプリを使って、家計管理を行ってきました。<br>
しかし、どのアプリを使用しても、以下の課題を感じていました。

### 課題 1：記録するだけでは不十分な家計簿

支出を記録することで、合計の出費を把握することはできます。

ですが、家計簿の結果から

- 自分の支出は多いのか少ないのか
- 蓄積された記録をどのように活かせばいいのか

が分からず、「お金が貯まっている実感」を得ることができませんでした。

この原因は**事前に予算を設定していない**ことだと考えています。<br>
予算を決めていないため、「何にいくら使っていいか」の基準がなく、支出の適切性を判断できませんでした。

### 課題 2：パートナーとの煩雑な精算処理

パートナーと二人暮らしをしていた際、生活費をそれぞれで支払い、月末に精算していました。<br>
しかし、この精算作業は煩雑で、手間なく管理できる方法を探していました。

### 解決策: 統合型の家計管理アプリ

これらの課題を解決するため、以下の機能を持つアプリケーションを開発しました。

1. **予算管理機能**: カテゴリー別に予算を設定し、実績と比較
2. **個人/共有モード**: 1 つのアプリで個人と共有の家計を管理
3. **支払い担当者の記録**: 誰が支払ったかを記録し、自動精算を実現

ラクに、でも効果的な家計管理を行える。<br>
そんな体験をユーザーに提供すべく、本 Web サービスの開発しました。

## 2.機能一覧

- 認証

  - ログイン / ログアウト
    - AWS Cognito による認証
    - JWT トークンベース
    - トークンの自動リフレッシュ（セッション維持）
  - ユーザー登録
    - メールアドレスとパスワードで登録
    - 確認コードによるメールアドレス検証

- アカウント管理

  - ユーザー名の変更
  - パートナー連携 / 解除
  - パスワードの変更 / リセット
  - メールアドレスの変更
  - アカウント削除

- ユーザーモード切り替え

  - 個人モード
    - ログインユーザーが登録した明細のみ表示
  - 共有モード
    - ログインユーザーとそのパートナーが登録した明細が表示
    - 支払い担当者を記録し、分担を可視化

- 明細管理

  - 明細の登録 / 更新 / 削除
  - ファイナンスモード切り替えによる表示変更
  - 明細の表示（月次ビュー）

    - テーブル形式での明細一覧表示
    - カテゴリー別円グラフによる支出割合の可視化
    - 月間合計金額の表示

  - 明細の表示（年次ビュー）

    - カテゴリー別・月別の支出推移を棒グラフで可視

- 予算管理

  - カテゴリー別に予算の登録 / 更新
  - 月別予算消化状況の表示
  - 残予算の自動計算

- サブスクリプション管理

  - サブスクリプション登録 / 更新 / 削除
  - 登録したサブスクリプションを月次明細に自動反映

## 3.画面

### 3-1.アカウント作成 / ログイン

#### アカウント作成

[gif 入れる]

**機能**

- メールアドレス認証

  - アカウントの新規作成には「メールアドレス認証」を採用しました。<br>
    これにより不正にアカウントを作成することを防ぎ、セキュリティ面の向上を図りました。

- リアルタイムバリデーション

  - パスワードにはリアルタイムバリデーションを導入しました。<br>
    これによりパスワードの設定ルールをフォーム送信前にユーザーに伝えることができ、UX の向上を図りました。

#### ログイン方法

[gif 入れる]

**機能**

- ログイン

  - 認証には AWS Cognito を採用しました。<br>
    これにより、セキュアな認証基盤を構築し、JWT トークンによる安全なセッション管理を実現しました。

### 3-2.支出管理 / 家計簿

#### 支出管理

[gif 入れる]

**機能**

- 明細の登録

  - 登録した明細は、カテゴリーごとに分類されて支出管理表に表示されます。
  - 必須項目が未入力の場合は保存ボタンを無効化し、意図しないデータの送信を防いでいます。

- 明細の表示（月次ビュー）

  - 登録した明細をテーブル形式で一覧表示します。

- 明細の編集・削除

  - 支出管理表の明細をクリックすると編集モーダルが表示され、値の変更や削除を行うことができます。

- トーストを使った結果表示

  - 操作結果をトースト通知で表示し、時間経過で自動的に消えることで UX の向上を図りました。

#### 家計簿

[gif 入れる]

**機能**

- 明細の表示（月次ビュー）

  - 登録した明細を、家計簿として可視化します。
  - カテゴリー別の円グラフで支出割合を視覚的に表示しています。

- 明細の表示（年次ビュー）

  - 月ごとにカテゴリー別で支出の推移を表示しています。
  - カテゴリー別・月別の支出推移を棒グラフで表示しています。<br>
    これにより、各カテゴリーの支出トレンドを一目で把握できます。

- 明細の登録・編集・削除

  - 支出管理と同じ明細操作をこのページでも行うことができます。

### 3-3.予算 / サブスクリプションの設定画面

#### 予算

[gif 入れる]

**機能**

- 予算の登録・更新

  - カテゴリーごとに月間または年間の予算を設定することができます。
  - 登録した予算は支出管理表に表示され、予算額・支出額・残予算を一目で確認できます。

- 予算消化状況の表示

  - 年間予算を設定したカテゴリーについて、月別の予算消化状況を表示します。
  - 12 ヶ月分の支出推移を一覧で確認でき、年間の予算管理を効率的に行えます。

#### サブスクリプション

[gif 入れる]

**機能**

- サブスクリプションの登録・更新・削除

  - サービス名称、更新間隔（月額 / 年額）、金額、契約期間（開始日 / 終了日）を設定できます。

- 支出管理への表示

  - 登録したサブスクリプションは、支出管理表と家計簿に自動的に明細として反映されます。
  - 年額の場合は月額換算（年額 ÷12）で表示されます。

### 3-4.アカウントの設定画面

ユーザー名変更 / ログイン情報変更
[gif 入れる]

パートナー設定
[gif 入れる]

**機能**

- ユーザー名の変更

  - 表示名を 10 文字以内で設定できます。

- パートナー連携

  - パートナーのユーザー ID を入力して連携できます。
  - 連携することでユーザーモードの切り替え（個人/共有）が可能になります。<br>
    共有モードでは、パートナーと明細を共有し、支払い分担を可視化できます。

- パートナー解除

  - パートナー連携を解除できます。<br>
    解除すると、共有モードで登録した予算・明細・サブスクリプションも削除されます。

- メールアドレス・パスワードの変更

  - AWS Cognito 経由でメールアドレスとパスワードを変更できます。

## 4.技術スタック

### 4-1.使用技術

本プロジェクトを構成する、主要な技術を紹介します。

| カテゴリ           | 技術                                                                                                    |
| ------------------ | ------------------------------------------------------------------------------------------------------- |
| フロントエンド     | Next.js 15.5.2 / React 19.1.0 / TypeScript 5.9.2                                                        |
| バックエンド       | PHP 8.4 / Laravel 12.0                                                                                  |
| データベース       | MySQL 8.4                                                                                               |
| 認証               | AWS Cognito / AWS Amplify 6.15.6                                                                        |
| データフェッチング | SWR / Fetch API                                                                                         |
| 環境構築           | Docker / Docker Compose                                                                                 |
| CI/CD              | Github Actions                                                                                          |
| インフラ           | S3 / CloudFront / ECR / ECS Fargate / VPC / RDS /<br>ALB / Route53 / ACM / CloudWatch / Systems Manager |
| UI/スタイリング    | Shadcn/ui / Tailwind CSS                                                                                |
| コード品質         | ESLint / Prettier / PHPUnit / Laravel Pint                                                              |

#### 技術選定理由

【フロントエンド】
Web アプリケーションでありながらもユーザーに高速で快適な操作感を提供することを最優先に考えました。そのため、シングルページアプリケーション（SPA）の開発に最適だと判断した、React と Next.js を採用しました。
React は再利用可能な UI コンポーネントを簡単に作成でき、開発効率と保守性を向上させることが期待できます。Next.js はサーバーサイドレンダリング（SSR）や静的サイト生成（SSG）などの機能を実装することにより、SPA のデメリットである初回ロード時間を短縮することが可能です。
また、家計簿アプリは入力したデータを様々な形で表示することが想定されたため、型を厳重に管理できる TypeScript を導入しました。
これにより型安全性と開発時の自動補完を利用し、データを扱う際に予期せぬバグが発生するリスクを減少させたいと考えました。

【バックエンド】
Laravel は Web アプリケーションに必要な標準機能を提供しており、迅速にアプリケーションを構築できると考えた。

【データベース】
一般的な MySQL を使った

【認証】
運営者側でユーザーのアカウント情報を管理したくない。
JWT トークンによるセキュアな認証を実装できる
ため、AWS Cognito を採用しました。
結果、ログイン時もそうですが、自動でトークンの更新を行ったり、期限切れのトークンを持つ場合は再ログインを促したりと、
セキュアな環境を作るのがとても簡単だった。

【データフェッチング】
データの更新および表示をリアルタイムで行うため採用しました。
キャッシング機能とデータ再検証戦略により、アプリケーションのパフォーマンスを向上させ、ユーザーに最新の情報を迅速に提供することができます。SWR は自動的なデータ更新と最適化されたデータフェッチを実現し、ユーザー体験を向上させることができると思いました。

【環境構築】
自身の PC が汚れるのを防ぐため。
開発環境に差分が生じる可能性を抑えるため。
Docker を導入しました。

【CI/CD】
デプロイの自動化を行い、開発効率の向上のため、AWS へのデプロイを GitHub Actions により自動化しました。

【インフラ】
実際の現場で使用されることの多い技術を使用したかったためです。

【UI/スタイリング】
React が推奨している Tailwind CSS と Shadcn/UI を使った。
これらを活用することで複雑なフロントエンドの作成を効率的に実施することができた。
そもそものデザインがモダンで使いやすく、また個人的に好みなシンプルなデザインだったため採用しました。

【コード品質】
プロジェクト立ち上げ時に厳格なルールを取り入れることで、技術負債を残させない仕組みにしたかった。
そのため早期から ESLint や Prettier、laravel Pint を取り入れ、コードの品質を担保しました。
デプロイ後は、GitHub Actions にて自動チェックを入れることで、精査されていないコードがマージされることを仕組みで防げるようにしました。

### 4-2.データベース設計（ER 図）

[ER 図を追加]

### 4-3.インフラ構成図

[インフラ構成図を追加]

## 5.アプリ開発の振り返り

### 5-1.こだわった実装（4 ～ 5 こ）

- UI/UX

  - SWR を利用することで入力した内容がその場で更新されるようにした
    - 2 回目のアクセス時にキャッシュからデータを返すのでレスポンス速度が向上する。ユーザーにロードのストレスを感じさせない操作感を提供できた
    - 先にデータの更新を行い、後からバックエンドとデータの整合性を取る仕組みになっている。ほぼリアルタイムでのデータ更新が実現できた。
  - shadcnui と tailwindcss を活用することで、モダンなデザインのサイトを開発コストを抑えて構築することが出来た
    - コンポーネント単位での使用ができるため、学習初期に React のコンポーネントの概念を理解するのに役立った

- 認証機能（JWT トークンの活用、リアルタイムバリデーションなど）

- 共有モード・couple 機能の実装方法（個人、共有のデータ取得）

- 支出管理の表示

  - 支出管理の ROW 表示（予算とカテゴリーのまとめと、詳細の明細をどう表示させているのか）
  - ６つの象限に分かれたカテゴリーを用意し、表示させている。通常の家計簿アプリとは違った区切りで作成した。リベラルアーツ大学という Youtube コンテンツを学習しており、リベ大が提唱している支出管理の考え方を参考にした。
  - 予算の表示。予算が登録してある/ない。予算が 0 円である/1 円以上である。などで細かく条件分岐することで、予算が登録されている時は表示される仕組みを実装している
    また、実績がなくとも予算を作成していたら、収支に表示されるようにした。支出管理＝家計簿ではない（年間の予算を 12 で割って月の予算を決めるなど）が、この仕組みを導入することでただの支出入力がうまく支出管理とまじりあうようにした。

- 家計簿のグラフ表示（どのようなデータ整形を行っているのか）

- サブスクリプション機能

  - サブスクとして登録した内容が支出管理にも表示される

### 5-2.苦労した点

## 6.今後の展望

- Google 認証機能

- スマホアプリ対応

  - 支出の入力はやはりスマホの方が手軽でよい

- カテゴリーのカスタマイズ機能

  - 教育費、車検費、税金など。人の特性に応じて不要なカテゴリーがある
  - 浪費、投資の項目だけは好きに増やせてもよいかも（それ以外は不要。このアプリの特徴だし）

- 明細の自動取得（カード会社のと API 連携）

- 支出のカレンダー表記機能

  - 一部ユーザーからカレンダー形式での表示機能を実装を求められた。多くの工数がかかる見込みなので、時間と満足度の兼ね合いを慎重に見極めて必要次応じて実装する・

- ユーザー増やす

  - SNS での発信。リベシティ内での紹介
